<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chill Data Dashboard (2026 Comparison)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --primary: #2c5f2d; --secondary: #97bc62; --bg: #f4f7f6; --text: #333; --white: #fff; --border: #ddd; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); color: var(--text); margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 20px; }
        .controls-row { display: flex; justify-content: center; align-items: center; gap: 20px; margin-bottom: 20px; flex-wrap: wrap; }
        .btn-group { display: flex; gap: 5px; }
        .btn { padding: 8px 16px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; background-color: #ddd; }
        .btn.active { background-color: var(--primary); color: var(--white); }
        select { padding: 8px; border-radius: 5px; border: 1px solid var(--border); font-size: 14px; cursor: pointer; }
        .card { background: var(--white); padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.9em; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid var(--border); }
        th { background-color: var(--primary); color: var(--white); }
        .progress-bar { height: 8px; background-color: #eee; border-radius: 4px; width: 80px; display: inline-block; margin-right: 5px; }
        .progress-fill { height: 100%; background-color: var(--secondary); border-radius: 4px; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>District Chill Comparison</h1>
        <p>Current Date: Jan 11, 2026</p>
    </header>

    <div class="controls-row">
        <div class="btn-group">
            <button class="btn active" id="btn-hours" onclick="setMetric('hours')">Chill Hours</button>
            <button class="btn" id="btn-portions" onclick="setMetric('portions')">Chill Portions</button>
        </div>
        
        <div>
            <label for="yearSelect"><strong>Compare Against:</strong></label>
            <select id="yearSelect" onchange="setHistoricYear(this.value)">
                <option value="2025">Historic 2025 (Previous Year)</option>
                <option value="2024">Historic 2024 (2 Years Ago)</option>
            </select>
        </div>
    </div>

    <div class="card">
        <canvas id="mainChart" height="100"></canvas>
    </div>

    <div class="card">
        <table id="dataTable">
            <thead>
                <tr>
                    <th>Location</th>
                    <th>2026 Current</th>
                    <th id="historicHeader">2025 Historic</th>
                    <th>% of Historic</th>
                    <th>Goal Progress (F. Kerm)</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>
    </div>
</div>

<script>
    // Data sourced from PDF 
    const data = [
        { loc: "STV 28", h26: 569, h25: 607, h24: 542, p26: 39, p25: 41, p24: 33 },
        { loc: "STV 27 SW", h26: 596, h25: 663, h24: 591, p26: 37, p25: 38, p24: 34 },
        { loc: "STV 27 SE", h26: 568, h25: 628, h24: 555, p26: 38, p25: 39, p24: 32 },
        { loc: "STV 27 NE", h26: 574, h25: 621, h24: 552, p26: 39, p25: 41, p24: 33 },
        { loc: "STV 22", h26: 574, h25: 628, h24: 566, p26: 39, p25: 38, p24: 33 },
        { loc: "STV 26D", h26: 555, h25: 583, h24: 537, p26: 38, p25: 38, p24: 31 },
        { loc: "STV 35", h26: 552, h25: 584, h24: 511, p26: 36, p25: 41, p24: 31 },
        { loc: "STV 2", h26: 585, h25: 616, h24: 535, p26: 39, p25: 39, p24: 32 },
        { loc: "STV 3", h26: 590, h25: 631, h24: 533, p26: 38, p25: 38, p24: 31 },
        { loc: "STV 4", h26: 563, h25: 572, h24: 482, p26: 39, p25: 38, p24: 33 },
        { loc: "HL 32 NW", h26: 573, h25: 589, h24: 488, p26: 39, p25: 41, p24: 36 },
        { loc: "KL", h26: 528, h25: 607, h24: 519, p26: 38, p25: 36, p24: 33 },
        { loc: "BV", h26: 596, h25: 614, h24: 546, p26: 39, p25: 38, p24: 31 }
    ];

    let currentMetric = 'hours'; // hours or portions
    let historicYear = '2025';
    let chartObj = null;

    function setMetric(m) {
        currentMetric = m;
        document.getElementById('btn-hours').classList.toggle('active', m === 'hours');
        document.getElementById('btn-portions').classList.toggle('active', m === 'portions');
        updateUI();
    }

    function setHistoricYear(y) {
        historicYear = y;
        updateUI();
    }

    function updateUI() {
        const histLabel = historicYear + " Historic";
        document.getElementById('historicHeader').innerText = histLabel;
        
        const goalVal = currentMetric === 'hours' ? 800 : 58; // Female Kerman goals 
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = '';

        const chartLabels = [];
        const chartCur = [];
        const chartHist = [];

        data.forEach(d => {
            const cur = currentMetric === 'hours' ? d.h26 : d.p26;
            const hist = currentMetric === 'hours' ? (historicYear === '2025' ? d.h25 : d.h24) : (historicYear === '2025' ? d.p25 : d.p24);
            
            const pctOfHist = Math.round((cur / hist) * 100);
            const pctOfGoal = Math.round((cur / goalVal) * 100);

            const row = `<tr>
                <td><strong>${d.loc}</strong></td>
                <td>${cur}</td>
                <td>${hist}</td>
                <td>${pctOfHist}%</td>
                <td>
                    <div class="progress-bar"><div class="progress-fill" style="width:${Math.min(pctOfGoal, 100)}%"></div></div>
                    ${pctOfGoal}%
                </td>
            </tr>`;
            tbody.innerHTML += row;

            chartLabels.push(d.loc);
            chartCur.push(cur);
            chartHist.push(hist);
        });

        renderChart(chartLabels, chartCur, chartHist, histLabel);
    }

    function renderChart(labels, cur, hist, histLabel) {
        const ctx = document.getElementById('mainChart').getContext('2d');
        if (chartObj) chartObj.destroy();
        chartObj = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [
                    { label: '2026 Current', data: cur, backgroundColor: '#2c5f2d' },
                    { label: histLabel, data: hist, backgroundColor: '#97bc62' }
                ]
            },
            options: { responsive: true, scales: { y: { beginAtZero: true } } }
        });
    }

    updateUI();
</script>
</body>
</html>
